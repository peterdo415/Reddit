# バグ改修 TODO

このファイルはバグ修正・改修タスクを管理するためのものです。

## バグ修正タスク
- [x] testユーザーでログイン後には表示される投稿が、画面更新したら投稿が表示されなくなる問題を修正
- [x] ログイン後にサイドバーに所属コミュニティが反映されない問題を修正（更新処理が必要）
- [x] 投稿のコメント数（comments_count）がDBと画面でズレる問題を修正
    - Supabase側で全投稿のcomments_countを再集計SQLで一括修正
    - コメント追加・削除時にupdate_comments_count関数（Supabase Function）を必ず呼ぶよう徹底
    - post_hot_scoresビューもcomments_countを必ず含めるよう修正
- [ ] 新規投稿時、DBに存在する全てのコミュニティから選択できるようにする（現在は所属コミュニティのみ選択可能）
    - デフォルトで所属コミュニティをサジェスト表示
    - 残りのコミュニティは検索で選択可能に（1文字入力ごとに検索、本家Redditと同じUI/仕様）
- [ ] コミュニティ名の日本語対応
    - display_name（表示名）は日本語・多言語を許可し、バリデーションを緩和
    - name（URL用）は英小文字・数字・アンダースコアのみ許可（現状維持）
    - Supabaseの全文検索インデックスを日本語対応に変更
    - コミュニティ作成・編集時のバリデーション・UI文言も日本語対応に修正
    - 既存のコミュニティ検索・表示も日本語対応を確認

---

※新しいバグや修正タスクが発生した場合は、上記リストに追加してください。 